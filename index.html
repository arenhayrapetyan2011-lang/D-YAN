<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>d'YAN | Premium Athletic Wear</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&display=swap" rel="stylesheet">
<style>
/* --- VARIABLES & RESET --- */
:root {
--bg-color: #f4f4f4;
--text-main: #000000;
--transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
font-family: 'Inter', sans-serif;
background-color: var(--bg-color);
color: var(--text-main);
overflow-x: hidden;
width: 100vw;
min-height: 100vh;
}

a { text-decoration: none; color: inherit; cursor: pointer; }
button { cursor: pointer; font-family: inherit; }

/* --- UTILS --- */
.overflow-text {
white-space: nowrap;
font-size: 15vw;
font-weight: 900;
line-height: 0.8;
text-transform: uppercase;
position: absolute;
z-index: -1;
color: rgba(0,0,0,0.05);
pointer-events: none;
user-select: none;
}

/* --- NAVIGATION --- */
.navbar {
display: flex;
justify-content: space-between;
align-items: center;
padding: 20px 40px;
height: 80px;
position: fixed;
top: 0;
width: 100%;
z-index: 1000;
mix-blend-mode: difference;
color: white;
}

.logo { font-weight: 900; font-size: 28px; letter-spacing: -2px; text-transform: uppercase; }
.nav-center { display: flex; gap: 40px; }
.nav-center a { font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
.nav-right { display: flex; align-items: center; gap: 25px; font-size: 14px; font-weight: 600; }
.hamburger { display: none; flex-direction: column; gap: 6px; cursor: pointer; }
.hamburger span { width: 30px; height: 3px; background-color: white; }

/* --- MOBILE MENU --- */
.mobile-menu {
position: fixed; top: 0; left: 0; width: 100%; height: 0;
background: #111; color: white; overflow: hidden; transition: var(--transition);
display: flex; flex-direction: column; justify-content: center; padding: 0 40px; z-index: 999;
}
.mobile-menu.active { height: 100vh; }
.mobile-menu a { font-size: 8vw; font-weight: 900; margin-bottom: 10px; text-transform: uppercase; line-height: 0.9; }

/* --- HERO SECTION --- */
.hero {
position: relative;
min-height: 100vh;
display: flex;
align-items: center;
justify-content: center;
overflow: hidden;
padding-top: 80px;
}

.hero-bg-text {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
font-size: 25vw;
font-weight: 900;
white-space: nowrap;
color: transparent;
-webkit-text-stroke: 2px #e0e0e0;
z-index: 1;
opacity: 0.5;
animation: marqueeText 30s linear infinite;
}
@keyframes marqueeText {
0% { transform: translate(-20%, -50%); }
100% { transform: translate(-80%, -50%); }
}

.hero-content {
position: relative;
z-index: 3;
text-align: left;
max-width: 400px;
margin-right: -200px;
}

.hero h1 {
font-size: 6vw;
line-height: 0.85;
font-weight: 900;
letter-spacing: -3px;
text-transform: uppercase;
color: #111;
margin-bottom: 20px;
}

.hero-image {
width: 45vw;
height: 70vh;
z-index: 2;
position: relative;
overflow: hidden;
transform: rotate(-3deg);
box-shadow: 20px 20px 60px rgba(0,0,0,0.1);
}
.hero-image img {
width: 100%;
height: 100%;
object-fit: cover;
scale: 1.2;
}

.btn-primary {
padding: 20px 50px;
background-color: #000;
color: white;
border: none;
font-weight: 700;
text-transform: uppercase;
font-size: 14px;
letter-spacing: 1px;
transition: var(--transition);
margin-top: 20px;
position: relative;
}
.btn-primary:hover { background-color: #333; transform: translateY(-5px); }

/* --- COLLECTION HERO --- */
.collection-hero {
position: relative;
height: 50vh;
display: flex;
align-items: center;
justify-content: center;
overflow: hidden;
margin-top: 80px;
background: #f4f4f4;
}

.collection-bg-text {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
font-size: 20vw;
font-weight: 900;
white-space: nowrap;
color: transparent;
-webkit-text-stroke: 2px #d0d0d0;
z-index: 0;
animation: marqueeText 20s linear infinite;
}

#collection-title {
position: relative;
z-index: 2;
font-size: 8vw;
line-height: 0.8;
font-weight: 900;
text-transform: uppercase;
color: black;
text-align: center;
}

/* --- PRODUCTS GRID --- */
.products-section { max-width: 1600px; margin: 0 auto; padding: 100px 40px; position: relative; }
.section-header {
display: flex;
justify-content: space-between;
align-items: flex-end;
margin-bottom: 80px;
padding-bottom: 20px;
}
.section-header h2 { font-size: 60px; font-weight: 900; line-height: 0.8; text-transform: uppercase; }

.product-grid {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 40px;
width: 100%;
}

.product-card { cursor: pointer; position: relative; }
.card-image {
background-color: #e5e5e5;
width: 100%;
aspect-ratio: 3/4;
overflow: hidden;
margin-bottom: 20px;
position: relative;
}
.card-image img { 
width: 100%; height: 100%; object-fit: cover; 
transition: transform 0.8s ease; 
}
.product-card:hover .card-image img { transform: scale(1.1); }

.badge {
position: absolute; top: 0; left: 0;
background: #000; color: white;
padding: 10px 20px; font-size: 14px; font-weight: 800; z-index: 2;
text-transform: uppercase;
}

.card-details h3 { font-size: 24px; font-weight: 800; text-transform: uppercase; margin-bottom: 5px; }
.card-details .category { color: #888; font-size: 14px; text-transform: uppercase; margin-bottom: 8px; display: block;}
.card-details .price { font-weight: 800; font-size: 18px; display: block; margin-top: 10px;}

/* --- SEARCH & SELECTION OVERLAY --- */
.overlay {
position: fixed; top: 0; left: 0; width: 100%; height: 100%;
background: rgba(255,255,255,0.98); z-index: 2000;
display: none; align-items: center; justify-content: flex-start; flex-direction: column;
animation: fadeIn 0.3s ease;
padding-top: 100px;
}
.overlay.active { display: flex; }
.close-icon {
position: absolute; top: 40px; right: 40px; font-size: 30px; cursor: pointer; z-index: 2005;
mix-blend-mode: difference; color: white;
}

/* SEARCH SPECIFIC CSS */
.search-input-container {
width: 80%;
max-width: 1200px;
position: relative;
margin-bottom: 40px;
}
#search-input {
width: 100%; border:none; border-bottom: 4px solid black;
font-size: 40px; font-weight:900; outline:none; text-transform:uppercase;
background: transparent; padding-bottom: 10px;
}
#search-results-area {
width: 80%;
max-width: 1200px;
height: 60vh;
overflow-y: auto;
padding-bottom: 50px;
}
.search-section-title {
font-size: 14px; color: #888; font-weight: 700; text-transform: uppercase; margin-bottom: 20px; letter-spacing: 1px;
}
.search-grid {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 20px;
}
.search-grid .product-card h3 { font-size: 16px; }
.search-grid .product-card .price { font-size: 14px; }

/* CHECKOUT SPECIFIC CSS */
#checkout-overlay {
justify-content: center;
padding-top: 0;
background: rgba(0,0,0,0.8);
backdrop-filter: blur(5px);
}
.checkout-modal {
background: white;
width: 90%;
max-width: 500px;
padding: 40px;
position: relative;
box-shadow: 0 20px 50px rgba(0,0,0,0.3);
}
.checkout-header {
font-size: 24px; font-weight: 900; text-transform: uppercase; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 20px;
display: flex; justify-content: space-between; align-items: center;
}
.payment-methods {
display: flex; gap: 10px; margin-bottom: 30px;
}
.pm-btn {
flex: 1; border: 1px solid #ddd; padding: 15px; text-align: center;
cursor: pointer; font-weight: 700; text-transform: uppercase; font-size: 12px;
transition: all 0.3s;
}
.pm-btn:hover { background: #f9f9f9; }
.pm-btn.selected { border: 2px solid black; background: black; color: white; }

.form-group { margin-bottom: 20px; }
.form-label { display: block; font-size: 11px; font-weight: 700; text-transform: uppercase; color: #666; margin-bottom: 8px; letter-spacing: 0.5px;}
.form-input {
width: 100%; border: none; border-bottom: 1px solid #ddd;
padding: 10px 0; font-family: 'Inter', sans-serif; font-size: 16px; font-weight: 600;
background: transparent; outline: none; transition: border-color 0.3s;
}
.form-input:focus { border-bottom: 2px solid black; }

.form-row { display: flex; gap: 20px; }

/* Gender Select Styling */
#gender-selection-overlay { padding-top: 0; justify-content: center; }
.selection-options {
display: flex;
flex-direction: row;
gap: 0;
width: 100%;
height: 100vh;
}
.option-card {
flex: 1; position: relative; overflow: hidden; cursor: pointer;
transition: var(--transition);
height: 100%;
}
.option-card:hover { flex: 1.5; }
.option-card img { width: 100%; height: 100%; object-fit: cover; }
.option-label {
position: absolute; bottom: 30px; left: 30px; color: white;
font-size: 3vw; font-weight: 900; text-transform: uppercase; line-height: 1;
mix-blend-mode: difference;
}

/* --- VIEW UTILS --- */
.view-section { display: none; animation: fadeIn 0.8s cubic-bezier(0.19, 1, 0.22, 1); }
.view-section.active { display: block; }

@keyframes fadeIn {
from { opacity: 0; transform: translateY(50px); }
to { opacity: 1; transform: translateY(0); }
}

/* --- RESPONSIVE --- */
@media (max-width: 768px) {
.navbar { mix-blend-mode: normal; color: black; background: rgba(255,255,255,0.9); }
.hamburger span { background: black; }
.nav-center { display: none; }
.hamburger { display: flex; }
.hero { flex-direction: column-reverse; padding-top: 120px; justify-content: flex-start;}
.hero-image { width: 90%; height: 50vh; transform: rotate(0); margin-bottom: -50px; z-index: 1;}
.hero-content { margin: 0; text-align: center; z-index: 2; }
.hero h1 { font-size: 15vw; color: black; background: rgba(255,255,255,0.8); padding: 10px;}

.product-grid { grid-template-columns: 1fr; gap: 40px; }
.search-grid { grid-template-columns: 1fr 1fr; gap: 15px; }
#search-input { font-size: 24px; }

.selection-options { flex-direction: column; height: 100vh; }
.option-card:hover { flex: 1; }
.option-label { font-size: 8vw; }
}

/* Product Detail & Cart Styles */
.product-detail-container { max-width: 1400px; margin: 100px auto; display: grid; grid-template-columns: 1fr 1fr; gap: 80px; padding: 0 40px; }
.detail-info h1 { font-size: 5vw; line-height: 0.9; text-transform: uppercase; font-weight: 900; margin-bottom: 20px;}

.size-btn {
width: 60px; height: 60px;
border: 2px solid #000;
background: transparent;
font-weight: 700;
margin-right: 10px;
margin-bottom: 10px;
cursor: pointer;
transition: all 0.2s;
}
.size-btn:hover, .size-btn.selected { background: black; color: white; }

.cart-container { max-width: 800px; margin: 120px auto; padding: 0 20px; }
.cart-item { border-bottom: 2px solid #000; padding-bottom: 20px; margin-bottom: 20px; }

#zoom-container {
position: relative;
overflow: hidden;
background: #f0f0f0;
cursor: crosshair;
}
#p-img {
width: 100%;
height: 100%;
object-fit: cover;
transition: transform 0.2s ease-out;
transform-origin: center center;
will-change: transform;
}
</style>
</head>
<body>

<nav class="navbar">
<div class="nav-left">
<a onclick="router('home')" class="logo">d'YAN</a>
</div>
<div class="nav-center">
<a onclick="router('collection', {type: 'clothing'})">Clothing</a>
<a onclick="router('collection', {type: 'shoes'})">Shoes</a>
<a onclick="openGenderSelect('men')">Men</a>
<a onclick="openGenderSelect('women')">Women</a>
</div>
<div class="nav-right">
<a onclick="toggleSearch()" class="search-icon">Search</a>
<a onclick="router('cart')" class="cart-icon">Bag (<span id="cart-count">0</span>)</a>
<div class="hamburger" id="hamburger">
<span></span><span></span>
</div>
</div>
</nav>

<div class="mobile-menu" id="mobile-menu">
<div style="position: absolute; top: 20px; right: 20px; cursor: pointer; font-size: 40px;" onclick="document.getElementById('mobile-menu').classList.remove('active')">&times;</div>
<a onclick="router('collection', {type: 'clothing'})">Clothing</a>
<a onclick="router('collection', {type: 'shoes'})">Shoes</a>
<a onclick="openGenderSelect('men')">Men</a>
<a onclick="openGenderSelect('women')">Women</a>
</div>

<div class="overlay" id="search-overlay">
<div class="close-icon" onclick="toggleSearch()">&times;</div>
<div class="search-input-container">
<input type="text" id="search-input" placeholder="TYPE TO SEARCH..." autocomplete="off">
</div>
<div id="search-results-area">
<div id="search-recommendations">
<div class="search-section-title">Recommended For You</div>
<div class="search-grid" id="recommendations-grid"></div>
</div>
<div id="search-hits" style="display: none;">
<div class="search-section-title">Search Results</div>
<div class="search-grid" id="hits-grid"></div>
</div>
<div id="no-results" style="display: none; text-align: center; font-size: 20px; font-weight: 700; color: #999;">
NO RESULTS FOUND.
</div>
</div>
</div>

<div class="overlay" id="gender-selection-overlay">
<div class="close-icon" onclick="closeGenderSelect()">&times;</div>
<div class="selection-options">
<div class="option-card" onclick="selectCategory('clothing')">
<img id="img-clothing" src="" alt="Clothing">
<span class="option-label">Clothing</span>
</div>
<div class="option-card" onclick="selectCategory('shoes')">
<img id="img-shoes" src="" alt="Shoes">
<span class="option-label">SHOES</span>
</div>
</div>
</div>

<div class="overlay" id="checkout-overlay">
<div class="close-icon" style="top:20px; right:20px; color: black; mix-blend-mode: normal;" onclick="closeCheckout()">&times;</div>
<div class="checkout-modal">
<div class="checkout-header">
<span>Checkout</span>
<span id="checkout-total-display">$0.00</span>
</div>

<div class="form-label">Payment Method</div>
<div class="payment-methods">
<div class="pm-btn selected" onclick="selectPaymentMethod(this, 'card')">Credit Card</div>
<div class="pm-btn" onclick="selectPaymentMethod(this, 'apple')">Apple Pay</div>
</div>

<div id="card-form">
<div class="form-group">
<label class="form-label">Card Number</label>
<input type="text" class="form-input" placeholder="0000 0000 0000 0000">
</div>
<div class="form-group">
<label class="form-label">Name on Card</label>
<input type="text" class="form-input" placeholder="JOHN DOE">
</div>
<div class="form-row">
<div class="form-group" style="flex:1">
<label class="form-label">Expiry</label>
<input type="text" class="form-input" placeholder="MM/YY">
</div>
<div class="form-group" style="flex:1">
<label class="form-label">CVV</label>
<input type="text" class="form-input" placeholder="123">
</div>
</div>
</div>

<div id="alt-payment-msg" style="display:none; text-align:center; padding: 40px 20px; color: #000; font-weight: 600;">
<p style="margin-bottom: 10px; font-size: 18px;">? Pay</p>
Confirm on your device to complete purchase.
</div>

<button id="pay-btn" class="btn-primary" style="width: 100%; margin-top: 20px;" onclick="processPayment()">PAY NOW</button>
</div>
</div>

<div id="home-view" class="view-section active">
<header class="hero">
<div class="hero-bg-text">SPEED // POWER // AGILITY // SPEED // POWER</div>
<div class="hero-content">
<h1>Break<br>The<br>Cycle.</h1>
<p style="font-size: 18px; margin-bottom: 30px; background: white; display: inline-block; padding: 5px;">The Carbon X-1 Collection.</p>
<br>
<button class="btn-primary" onclick="router('collection', {tag: 'new'})">Explore Collection</button>
</div>
<div class="hero-image">
<img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=2070&auto=format&fit=crop" alt="Red Sneaker">
</div>
</header>

<section class="products-section">
<div class="overflow-text" style="right: -200px; top: 100px;">TRENDING</div>
<div class="section-header">
<h2>Latest<br>Drops</h2>
<a onclick="router('collection', {tag: 'trending'})" style="font-weight: 800; text-decoration: underline;">VIEW ALL</a>
</div>
<div class="product-grid" id="home-product-grid"></div>
</section>
</div>

<div id="collection-view" class="view-section">
<div class="collection-hero">
<div class="collection-bg-text">D'YAN // D'YAN // D'YAN // D'YAN // D'YAN // D'YAN</div>
<h1 id="collection-title">COLLECTION</h1>
</div>
<div class="products-section">
<div class="product-grid" id="collection-grid"></div>
</div>
</div>

<div id="product-view" class="view-section">
<div class="product-detail-container">
<div id="zoom-container">
<img id="p-img" src="" alt="">
</div>
<div class="detail-info">
<h1 id="p-title">Product Title</h1>
<span class="detail-price" id="p-price" style="font-size: 30px; font-weight: 700; margin-bottom: 40px; display:block;">$0.00</span>
<p id="p-desc" style="font-size: 18px; line-height: 1.6; margin-bottom: 40px; color: #555;">High-performance engineering designed for the modern athlete. Built for durability and style.</p>
<div style="margin-bottom: 40px;">
<p style="font-weight: 700; margin-bottom: 10px; text-transform: uppercase;">Size</p>
<div id="size-options-container" style="display: flex; flex-wrap: wrap;"></div>
</div>
<button class="btn-primary" style="width: 100%" onclick="addToCartCurrentProduct()">Add to Cart</button>
<button style="margin-top: 20px; border: none; background: none; text-decoration: underline; font-weight: 700;" onclick="router('home')">Back</button>
</div>
</div>
</div>

<div id="cart-view" class="view-section">
<div class="cart-container">
<h1 style="font-size: 60px; font-weight: 900; margin-bottom: 40px; text-transform: uppercase;">Your Bag</h1>
<div id="cart-items-container"></div>
<div style="margin-top: 60px; border-top: 4px solid black; padding-top: 20px; display: flex; justify-content: space-between; align-items: center;">
<span style="font-size: 24px; font-weight: 800;">TOTAL</span>
<span id="cart-total" style="font-size: 24px; font-weight: 800;">$0.00</span>
</div>
<button class="btn-primary" style="width: 100%; margin-top: 40px;" onclick="openCheckout()">Checkout</button>
</div>
</div>

<script>
const products = [
{ id: 1, name: "Atlas Runner V2", category: "Men's Running", type: 'shoes', gender: 'men', price: 140.00, image: "https://images.unsplash.com/photo-1606107557195-0e29a4b5b4aa?q=80&w=1964", badge: "New" },
{ id: 2, name: "Air Strider", category: "Women's Training", type: 'shoes', gender: 'women', price: 125.00, image: "https://images.unsplash.com/photo-1600185365926-3a2ce3cdb9eb?q=80&w=2025", badge: "" },
{ id: 3, name: "Court Vision", category: "Unisex Lifestyle", type: 'shoes', gender: 'men', price: 95.00, image: "https://images.unsplash.com/photo-1491553895911-0055eca6402d?q=80&w=2080", badge: "Best Seller" },
{ id: 4, name: "Retro Low", category: "Classics", type: 'shoes', gender: 'women', price: 110.00, image: "https://images.unsplash.com/photo-1560769629-975ec94e6a86?q=80&w=1964", badge: "" },
{ id: 5, name: "Core Tech Hoodie", category: "Men's Training", type: 'clothing', gender: 'men', price: 85.00, image: "https://images.unsplash.com/photo-1556821840-3a63f95609a7?q=80&w=1887", badge: "Hot" },
{ id: 6, name: "Aero Swift Tee", category: "Men's Running", type: 'clothing', gender: 'men', price: 45.00, image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=1780", badge: "" },
{ id: 7, name: "Flex Yoga Leggings", category: "Women's Yoga", type: 'clothing', gender: 'women', price: 75.00, image: "https://images.unsplash.com/photo-1506619216599-9d16d0903dfd?q=80&w=2069", badge: "New" },
{ id: 8, name: "Impact Sports Bra", category: "Women's Training", type: 'clothing', gender: 'women', price: 55.00, image: "https://images.unsplash.com/photo-1571945153237-4929e783af4a?q=80&w=1887", badge: "" }
];

let cart = [];
let currentProduct = null;
let currentGenderSelection = '';
let currentSelectedSize = null;
let currentPaymentMethod = 'card';

const menuImages = {
men: { clothing: "https://images.unsplash.com/photo-1516826957135-700dedea698c?q=80&w=1920", shoes: "https://images.unsplash.com/photo-1549298916-b41d501d3772?q=80&w=2012" },
women: { clothing: "https://images.unsplash.com/photo-1518310383802-640c2de311b2?q=80&w=1770", shoes: "https://images.unsplash.com/photo-1543163521-1bf539c55dd2?q=80&w=2080" }
};

/* --- CORE ROUTER --- */
function router(viewName, filterObj = null) {
document.querySelectorAll('.overlay').forEach(el => el.classList.remove('active'));
document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
document.getElementById('mobile-menu').classList.remove('active');
window.scrollTo(0,0);

if (viewName === 'home') {
document.getElementById('home-view').classList.add('active');
} else if (viewName === 'collection') {
document.getElementById('collection-view').classList.add('active');
let filtered = products;
let title = "COLLECTION";
if (filterObj) {
if (filterObj.tag) {
filtered = products.filter(p => p.badge);
title = filterObj.tag === 'new' ? "NEW ARRIVALS" : "TRENDING";
} else {
if (filterObj.gender) filtered = filtered.filter(p => p.gender === filterObj.gender);
if (filterObj.type) filtered = filtered.filter(p => p.type === filterObj.type);
title = (filterObj.gender || "") + " " + (filterObj.type || "");
}
}
document.getElementById('collection-title').innerText = title.toUpperCase();
renderGrid('collection-grid', filtered);
} else if (viewName === 'product') {
document.getElementById('product-view').classList.add('active');
loadProduct(filterObj);
} else if (viewName === 'cart') {
document.getElementById('cart-view').classList.add('active');
renderCart();
}
}

/* --- RENDER FUNCTIONS --- */
function renderGrid(containerId, list) {
const container = document.getElementById(containerId);
container.innerHTML = list.length ? '' : '<p>No items found.</p>';
list.forEach(p => {
const div = document.createElement('div');
div.className = 'product-card';
div.onclick = () => {
if(document.getElementById('search-overlay').classList.contains('active')) {
toggleSearch();
}
router('product', p.id);
};
div.innerHTML = `
<div class="card-image">
${p.badge ? `<span class="badge">${p.badge}</span>` : ''}
<img src="${p.image}" alt="${p.name}">
</div>
<div class="card-details">
<h3>${p.name}</h3>
<span class="category">${p.category}</span>
<span class="price">$${p.price}</span>
</div>`;
container.appendChild(div);
});
}

function loadProduct(id) {
const p = products.find(x => x.id === id);
currentProduct = p;
currentSelectedSize = null;
document.getElementById('p-img').src = p.image;
document.getElementById('p-title').innerText = p.name;
document.getElementById('p-price').innerText = `$${p.price}`;
const sizeContainer = document.getElementById('size-options-container');
sizeContainer.innerHTML = '';
let sizes = p.type === 'shoes' ? ['6', '7', '8', '9', '10', '11', '12'] : ['S', 'M', 'L', 'XL'];
sizes.forEach(size => {
const btn = document.createElement('button');
btn.className = 'size-btn';
btn.innerText = size;
btn.onclick = () => {
document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
btn.classList.add('selected');
currentSelectedSize = size;
};
sizeContainer.appendChild(btn);
});
}

function addToCartCurrentProduct() {
if(!currentSelectedSize) { alert("SELECT SIZE"); return; }
cart.push({...currentProduct, selectedSize: currentSelectedSize});
document.getElementById('cart-count').innerText = cart.length;
alert('ADDED TO BAG');
}

function renderCart() {
const container = document.getElementById('cart-items-container');
let total = 0;
container.innerHTML = cart.length ? '' : '<p>Empty bag.</p>';
cart.forEach((item, idx) => {
total += item.price;
container.innerHTML += `
<div class="cart-item" style="display:flex; justify-content:space-between;">
<div style="display:flex; gap: 20px;">
<img src="${item.image}" style="width:80px; height:80px; object-fit:cover;">
<div><h4>${item.name}</h4><p>SIZE: ${item.selectedSize}</p></div>
</div>
<button onclick="removeFromCart(${idx})">REMOVE</button>
</div>`;
});
document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
}

function removeFromCart(idx) { cart.splice(idx, 1); renderCart(); document.getElementById('cart-count').innerText = cart.length; }

/* --- CHECKOUT LOGIC --- */
function openCheckout() {
if(cart.length === 0) { alert("Your bag is empty."); return; }
const total = cart.reduce((acc, item) => acc + item.price, 0);
document.getElementById('checkout-total-display').innerText = `$${total.toFixed(2)}`;
// Reset to card default
selectPaymentMethod(document.querySelector('.pm-btn'), 'card');
document.getElementById('checkout-overlay').classList.add('active');
}

function closeCheckout() {
document.getElementById('checkout-overlay').classList.remove('active');
}

function selectPaymentMethod(btn, type) {
currentPaymentMethod = type;
document.querySelectorAll('.pm-btn').forEach(b => b.classList.remove('selected'));
btn.classList.add('selected');

const cardForm = document.getElementById('card-form');
const altMsg = document.getElementById('alt-payment-msg');
const payBtn = document.getElementById('pay-btn');

if(type === 'card') {
cardForm.style.display = 'block';
altMsg.style.display = 'none';
payBtn.innerText = "PAY NOW";
} else {
// Apple Pay Logic
cardForm.style.display = 'none';
altMsg.style.display = 'block';
payBtn.innerText = "PAY WITH ? PAY";
}
}

function processPayment() {
const btn = document.getElementById('pay-btn');
const originalText = btn.innerText;

if(currentPaymentMethod === 'apple') {
btn.innerText = "PROCESSING ? PAY...";
} else {
btn.innerText = "PROCESSING...";
}

btn.disabled = true;

setTimeout(() => {
alert("PAYMENT SUCCESSFUL! Thank you for your order.");
cart = [];
document.getElementById('cart-count').innerText = '0';
renderCart();
closeCheckout();
router('home');
btn.innerText = originalText;
btn.disabled = false;
}, 1500);
}

/* --- SEARCH LOGIC --- */
const searchInput = document.getElementById('search-input');
const recommendationsDiv = document.getElementById('search-recommendations');
const hitsDiv = document.getElementById('search-hits');
const noResultsDiv = document.getElementById('no-results');

function toggleSearch() {
const overlay = document.getElementById('search-overlay');
overlay.classList.toggle('active');

if (overlay.classList.contains('active')) {
searchInput.value = '';
searchInput.focus();
showRecommendations();
}
}

searchInput.addEventListener('input', (e) => {
const term = e.target.value.toLowerCase().trim();
if (term.length === 0) {
showRecommendations();
} else {
doSearch(term);
}
});

function showRecommendations() {
recommendationsDiv.style.display = 'block';
hitsDiv.style.display = 'none';
noResultsDiv.style.display = 'none';
const recs = products.slice(0, 4);
renderGrid('recommendations-grid', recs);
}

function doSearch(term) {
recommendationsDiv.style.display = 'none';
const hits = products.filter(p => p.name.toLowerCase().includes(term) || p.category.toLowerCase().includes(term));
if (hits.length > 0) {
hitsDiv.style.display = 'block';
noResultsDiv.style.display = 'none';
renderGrid('hits-grid', hits);
} else {
hitsDiv.style.display = 'none';
noResultsDiv.style.display = 'block';
}
}

/* --- OTHER UTILS --- */
function openGenderSelect(g) {
currentGenderSelection = g;
document.getElementById('img-clothing').src = menuImages[g].clothing;
document.getElementById('img-shoes').src = menuImages[g].shoes;
document.getElementById('gender-selection-overlay').classList.add('active');
}
function closeGenderSelect() { document.getElementById('gender-selection-overlay').classList.remove('active'); }
function selectCategory(t) { router('collection', {gender: currentGenderSelection, type: t}); }

// Zoom logic
const zCont = document.getElementById('zoom-container');
const zImg = document.getElementById('p-img');
zCont.onmousemove = (e) => {
const { left, top, width, height } = zCont.getBoundingClientRect();
zImg.style.transformOrigin = `${((e.clientX - left) / width) * 100}% ${((e.clientY - top) / height) * 100}%`;
zImg.style.transform = "scale(2.5)";
};
zCont.onmouseleave = () => zImg.style.transform = "scale(1)";

document.getElementById('hamburger').onclick = () => document.getElementById('mobile-menu').classList.add('active');

// Init Home Grid
renderGrid('home-product-grid', products.slice(0,4));

</script>
</body>
</html>